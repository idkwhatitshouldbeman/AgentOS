# AI-Powered Linux OS - Complete Project Description

## Project Vision

Build a Linux-based operating system where an **AI agent has deep system integration**:
- **Screen vision**: AI can see and understand what's on screen
- **Interaction**: AI can click, type, and control the UI
- **File management**: AI can read, write, and manage files with full control
- **System control**: AI has privileged access to control the entire PC (overclocking features deferred but architecture designed for it)
- **Clean UI**: Modern, minimal interface with AI always accessible
- **Local execution**: Everything runs on-device (no cloud dependencies)
- **Tested AI**: Every core AI behavior is backed by automated tests (unit, integration, and end-to-end)

## Development Philosophy

**Testing is mandatory**: No feature without tests. The user explicitly stated "idc how long it takes" - tests are non-negotiable.

**VM-first development**: 
- Start with Oracle VirtualBox for early development
- Move to QEMU/KVM for performance testing
- Eventually test on bare metal

**Test-driven development**: Write tests before features, ensure AI components are wrapped in testable interfaces.

## Current Project Structure

```
/home/aaroh/Downloads/AgentOS/
â”œâ”€â”€ README.md                    # High-level overview and quickstart
â”œâ”€â”€ PROJECT_STATUS.md            # This file - complete project description
â”œâ”€â”€ requirements.txt             # Python dependencies (pytest, etc.)
â”œâ”€â”€ pyproject.toml               # Pytest configuration
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ oracle-vm-setup.md      # Step-by-step Oracle VirtualBox setup instructions
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup-passwordless-sudo.sh    # Script to disable sudo password prompts (for automation)
â”‚   â””â”€â”€ check-iso-build.sh           # Script to check ISO build progress
â”‚
â”œâ”€â”€ src/
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ types.py            # Core data structures (Message, ToolCall, AgentStep, AgentResult)
â”‚       â”œâ”€â”€ llm_interface.py    # Abstract LLM backend interface + EchoBackend (for testing)
â”‚       â””â”€â”€ agent_core.py       # Core Agent class (minimal skeleton, single-step for now)
â”‚
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_agent_core.py      # Unit tests for Agent (using EchoBackend)
â”‚
â””â”€â”€ iso-build/                  # Directory for building custom Debian-based ISO
    â”œâ”€â”€ config/                 # live-build configuration
    â”‚   â”œâ”€â”€ package-lists/      # Custom packages to include
    â”‚   â”œâ”€â”€ includes.chroot/    # Files to include in the ISO
    â”‚   â””â”€â”€ archives/           # APT repository configuration
    â””â”€â”€ (build artifacts)        # .build/, cache/, etc. (generated by live-build)
```

## What's Been Implemented (Current State)

### âœ… Phase 1: Base Setup (COMPLETED)
- **Repository structure**: Python package layout with `src/`, `tests/`, `docs/`, `scripts/`
- **Testing framework**: pytest configured, basic test structure in place
- **Documentation**: Oracle VM setup guide created
- **ISO build setup**: Started building custom Debian-based ISO (currently in progress)

### âœ… Phase 2: Core Agent Skeleton (COMPLETED)
- **Data structures** (`src/agent/types.py`):
  - `Message`: role (user/system/assistant) + content
  - `ToolCall`: name + arguments dict
  - `AgentStep`: input messages + tool calls + output message
  - `AgentResult`: final result with messages + steps

- **LLM Interface** (`src/agent/llm_interface.py`):
  - Abstract `LLMBackend` class (interface for any LLM)
  - `EchoBackend`: Simple test backend that echoes user input
  - Designed to be easily mockable for tests

- **Agent Core** (`src/agent/agent_core.py`):
  - `Agent` class: Takes LLM backend, runs single-step agent loop
  - `AgentConfig`: Configuration (currently just max_response_tokens)
  - Minimal skeleton - will expand to multi-step planning later

- **Tests** (`tests/test_agent_core.py`):
  - Test that agent produces assistant message using EchoBackend
  - Test that max_response_tokens limit is respected
  - All tests pass with current implementation

### ðŸš§ Phase 1 (ISO Build) - IN PROGRESS
- **Current task**: Building custom Debian-based ISO using `live-build`
- **Location**: `/home/aaroh/Downloads/AgentOS/iso-build/`
- **Status**: Build process was started but may have failed due to Debian security repository configuration issues
- **Configuration**:
  - Base: Debian Bookworm (amd64)
  - Custom packages: vim, htop, python3, git, curl, wget
  - Custom MOTD: Welcome message for "AI-OS"
  - Security repo disabled (causing issues, needs fixing)
- **Next steps**: 
  - Fix security repository configuration
  - Complete ISO build
  - Verify ISO boots in VirtualBox

## What's NOT Implemented Yet (Next Steps)

### Phase 3: Local LLM Integration
- **TODO**: Integrate real LLM backend (llama.cpp or similar)
- **TODO**: Add quantized model support (7B-13B range)
- **TODO**: Tests with mocked model responses + a few slow tests with real model

### Phase 4: File Management Layer
- **TODO**: Implement file operation tools (read/write/move/delete) with API layer
- **TODO**: Safety tests (don't delete outside allowed paths)
- **TODO**: Integration tests with AI-driven file tasks
- **TODO**: File content understanding (text, code, images via vision)

### Phase 5: Screen Capture & Automation
- **TODO**: X11-based screen capture
- **TODO**: Vision model integration for screen understanding
- **TODO**: Mouse/keyboard automation (xdotool, pyautogui)
- **TODO**: UI element detection
- **TODO**: Test app for validating clicks/input

### Phase 6: Clean UI & AI Overlay
- **TODO**: Window manager (i3/sway or custom)
- **TODO**: Minimal desktop shell
- **TODO**: AI interface overlay (global hotkey, conversation view)
- **TODO**: Visual feedback for AI actions

### Phase 7: System Integration
- **TODO**: Privileged daemon for system control
- **TODO**: System APIs (process management, services, network)
- **TODO**: Security/audit logging
- **TODO**: Tests for privileged access model

### Phase 8+: QEMU/KVM & Bare Metal
- **TODO**: Set up QEMU/KVM with GPU passthrough
- **TODO**: Port E2E tests from Oracle VM
- **TODO**: Bare metal installation and testing

## Technical Stack

- **Language**: Python 3.10+ (for agent logic)
- **Testing**: pytest
- **Base OS**: Debian Bookworm (for the custom ISO)
- **Build tool**: live-build (Debian ISO creation)
- **Future**: C/C++/Rust for low-level components, llama.cpp for LLM

## Key Design Decisions

1. **Testable architecture**: AI components wrapped in deterministic interfaces
2. **VM-first**: All development happens in VMs before bare metal
3. **Local-only**: No cloud dependencies, everything runs on-device
4. **Security-conscious**: Privileged operations go through controlled daemon, not direct sudo
5. **Extensible**: Architecture designed to add new AI capabilities easily

## Current Work Status

**Active task**: ISO build is in progress (or may have failed - needs checking)

**Last action**: Attempted to build Debian-based ISO with custom packages and MOTD. Encountered security repository configuration issues. May need to:
- Check if build process is still running
- Fix sources.list configuration
- Restart build if needed

## How to Continue Work

1. **Check ISO build status**:
   ```bash
   /home/aaroh/Downloads/AgentOS/scripts/check-iso-build.sh
   ```

2. **If build failed**, fix configuration and restart:
   ```bash
   cd /home/aaroh/Downloads/AgentOS/iso-build
   # Fix sources.list issues
   sudo lb build
   ```

3. **Once ISO is ready**, test in VirtualBox:
   - Create VM with the ISO
   - Boot and verify it works
   - Install development tools inside VM
   - Clone this repo into VM
   - Run tests inside VM

4. **Next development phase**: Continue with Phase 3 (LLM integration) or Phase 4 (file management)

## Important Notes for Other Agents

- **DO NOT edit `design.plan.md`** - it's the source of truth design document (if it exists)
- **Testing is mandatory** - every feature needs tests
- **Passwordless sudo is configured** - `sudo` commands won't prompt for password
- **ISO build directory** (`iso-build/`) contains build artifacts - may have permission issues when searching
- **All code should be testable** - use dependency injection, mock interfaces, etc.
- **VM-first approach** - code runs in Oracle VM first, then QEMU/KVM, then bare metal

## File Locations Reference

- **Agent code**: `/home/aaroh/Downloads/AgentOS/src/agent/`
- **Tests**: `/home/aaroh/Downloads/AgentOS/tests/`
- **ISO build**: `/home/aaroh/Downloads/AgentOS/iso-build/`
- **Scripts**: `/home/aaroh/Downloads/AgentOS/scripts/`
- **Documentation**: `/home/aaroh/Downloads/AgentOS/docs/`

## Testing Philosophy

- **Unit tests**: Fast, test individual components with mocked dependencies
- **Integration tests**: Test agent + tools together in isolated environments
- **E2E tests**: Full scenarios in VM (boot OS, run AI, verify results)
- **AI regression tests**: Store prompts + expected behaviors, re-run after model changes

All tests should be deterministic where possible. AI model calls should be mockable.

